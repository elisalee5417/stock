name: Update Stock Dashboard

on:
  schedule:
    - cron: '0 1-7 * * 1-5' # å°ç£äº¤æ˜“æ™‚æ®µ
  workflow_dispatch: 

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: pip install yfinance pandas

      - name: Run script
        run: python stock.py

      - name: Check files # ğŸ” æ–°å¢é€™æ­¥ï¼šæª¢æŸ¥æª”æ¡ˆæœ‰æ²’æœ‰ç”Ÿå‡ºä¾†
        run: |
          ls -l
          if [ ! -f index.html ]; then
            echo "éŒ¯èª¤ï¼šindex.html æ²’æœ‰è¢«ç”¢ç”Ÿï¼è«‹æª¢æŸ¥ stock.py çš„é‚è¼¯ã€‚"
            exit 1
          fi

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: . # ç™¼ä½ˆç•¶å‰ç›®éŒ„
          # é€™è£¡æˆ‘å€‘åªæƒ³è¦ç¶²é æª”æ¡ˆï¼Œä¸æƒ³è¦åŸå§‹ç¢¼
          exclude_assets: '.github,stock.py,requirements.txt' 
          publish_branch: gh-pages
